ALTER TABLE MANITOU_TEST.DEMO_PRODUCT_INFO
 DROP PRIMARY KEY CASCADE;

DROP TABLE MANITOU_TEST.DEMO_PRODUCT_INFO CASCADE CONSTRAINTS;

CREATE TABLE MANITOU_TEST.DEMO_PRODUCT_INFO
(
  PRODUCT_ID           NUMBER                   NOT NULL,
  PRODUCT_NAME         VARCHAR2(50 BYTE),
  PRODUCT_DESCRIPTION  VARCHAR2(2000 BYTE),
  CATEGORY             VARCHAR2(30 BYTE),
  PRODUCT_AVAIL        VARCHAR2(1 BYTE),
  LIST_PRICE           NUMBER(8,2),
  PRODUCT_IMAGE        BLOB,
  MIMETYPE             VARCHAR2(255 BYTE),
  FILENAME             VARCHAR2(400 BYTE),
  IMAGE_LAST_UPDATE    DATE
)
LOB (PRODUCT_IMAGE) STORE AS BASICFILE (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING
      STORAGE    (
                  INITIAL          64K
                  NEXT             1M
                  MINEXTENTS       1
                  MAXEXTENTS       UNLIMITED
                  PCTINCREASE      0
                  BUFFER_POOL      DEFAULT
                 ))
TABLESPACE USERS
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
MONITORING;


CREATE UNIQUE INDEX MANITOU_TEST.DEMO_PRODUCT_INFO_PK ON MANITOU_TEST.DEMO_PRODUCT_INFO
(PRODUCT_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

CREATE OR REPLACE TRIGGER MANITOU_TEST."INSERT_DEMO_PROD"
BEFORE INSERT ON MANITOU_TEST.DEMO_PRODUCT_INFO
FOR EACH ROW
DECLARE
  prod_id number;
BEGIN
  SELECT demo_prod_seq.nextval
    INTO prod_id
    FROM dual;
  :new.PRODUCT_ID := prod_id;
END;
/


ALTER TABLE MANITOU_TEST.DEMO_PRODUCT_INFO ADD (
  CONSTRAINT DEMO_PRODUCT_INFO_PK
  PRIMARY KEY
  (PRODUCT_ID)
  USING INDEX MANITOU_TEST.DEMO_PRODUCT_INFO_PK
  ENABLE VALIDATE);
